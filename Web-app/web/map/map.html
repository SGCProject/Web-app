<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <link rel="import" type="text/html" href="../html/lib/include.html" />

        <link href="../js/libs/jqueryui/jquery-ui.min.css" rel="stylesheet" type="text/css"/>
        <script src="../js/libs/jquery/jquery.js" type="text/javascript"></script>
        <script src="../js/libs/jqueryui/jquery-ui.min.js" type="text/javascript"></script>
        <link href="../js/libs/jqueryui/jquery-ui.theme.min.css" rel="stylesheet" type="text/css"/>
        <script>
            $(function () {
                $(".showLookup").selectable();
                $('#dialogArea').dialog();
                $('#dialogPlace').dialog();
                $('#dialogType').dialog();
                $('#dialogTime').dialog();

                $('#dialogArea').add('#dialogPlace')
                        .add('#dialogType').add('#dialogTime')
                        .on("dialogclose", function (event, ui) {
                            var param = {};
                            var beforId;
                            var value = [];
                            var i = 0;

                            $('.showLookup').find('.ui-selected').each(function () {
                                var itemId = $(this).closest($('.showLookup')).attr('itemid');
                                itemId = itemId.charAt(0).toLowerCase() + itemId.slice(1);
                                var pk = $(this).attr('pk');

                                if (itemId != beforId && beforId != 'undefined') {
                                    param[beforId] = value;
                                    value = [];
                                    i = 0;
                                }
                                value[i++] = pk;
                                beforId = itemId;
                            });
                            param[beforId] = value;
                            
                            $.get(
                                    url + "Crime/q",
                                    {
                                        "area":[3,4]
                                    },
                                    function (data) {
                                        console.log(data);
                                    });
                        });


            });
        </script>
    </head>
    <body>
        <a href="#" onclick="$('#dialogArea').dialog('open');" >เขตพื้นที่</a>
        <a href="#" onclick="$('#dialogPlace').dialog('open');" >ประเภทสถานที่</a>
        <a href="#" onclick="$('#dialogTime').dialog('open');" >ช่วงเวลาเกิดเหตุ</a>
        <a href="#" onclick="$('#dialogType').dialog('open');" >ประเภทคดี</a>


        <!-- *************************************************************** -->
        <div id="dialogArea" title="เขตพื้นที่">
            <ol id="selectable" class="showLookup" itemid="Area">
                <li class="ui-widget-content ui-selected" pk="[pk]" >[name]</li>
            </ol>
        </div>
        <div id="dialogPlace" title="ประเภทสถานที่">
            <ol id="selectable" class="showLookup" itemid="Place">
                <li class="ui-widget-content ui-selected" pk="[pk]" >[name]</li>
            </ol>
        </div>
        <div id="dialogTime" title="ช่วงเวลาเกิดเหตุ<">
            <ol id="selectable" class="showLookup" itemid="Time">
                <li class="ui-widget-content ui-selected" pk="[pk]" >[time_lange]</li>
            </ol>
        </div>
        <div id="dialogType" title="ประเภทคดี">
            <ol id="selectable" class="showLookup" itemid="Type">
                <li class="ui-widget-content ui-selected" pk="[pk]" >[name]</li>
            </ol>
        </div>

    </body>
    <script src="../js/libs/my.js" type="text/javascript"></script>
</html>
